<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="Javascript-load-image : JavaScript Load Image is a library to load images provided as File or Blob objects or via URL. It returns an optionally scaled and/or cropped HTML img or canvas element. It also provides a method to parse image meta data to extract Exif tags and thumbnails and to restore the complete image header after resizing.">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Javascript-load-image</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/jacknam/JavaScript-Load-Image">View on GitHub</a>

          <h1 id="project_title">Javascript-load-image</h1>
          <h2 id="project_tagline">JavaScript Load Image is a library to load images provided as File or Blob objects or via URL. It returns an optionally scaled and/or cropped HTML img or canvas element. It also provides a method to parse image meta data to extract Exif tags and thumbnails and to restore the complete image header after resizing.</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/jacknam/JavaScript-Load-Image/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/jacknam/JavaScript-Load-Image/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a id="javascript-load-image" class="anchor" href="#javascript-load-image" aria-hidden="true"><span class="octicon octicon-link"></span></a>JavaScript Load Image</h1>

<blockquote>
<p>A JavaScript library to load and transform image files.</p>
</blockquote>

<h2>
<a id="table-of-contents" class="anchor" href="#table-of-contents" aria-hidden="true"><span class="octicon octicon-link"></span></a>Table of contents</h2>

<ul>
<li><a href="#demo">Demo</a></li>
<li><a href="#description">Description</a></li>
<li><a href="#setup">Setup</a></li>
<li><a href="#usage">Usage</a></li>
<li><a href="#image-loading">Image loading</a></li>
<li><a href="#image-scaling">Image scaling</a></li>
<li><a href="#requirements">Requirements</a></li>
<li><a href="#api">API</a></li>
<li><a href="#options">Options</a></li>
<li><a href="#meta-data-parsing">Meta data parsing</a></li>
<li><a href="#exif-parser">Exif parser</a></li>
<li><a href="#ios-scaling-fixes">iOS scaling fixes</a></li>
<li><a href="#license">License</a></li>
<li><a href="#credits">Credits</a></li>
</ul>

<h2>
<a id="demo" class="anchor" href="#demo" aria-hidden="true"><span class="octicon octicon-link"></span></a>Demo</h2>

<p><a href="https://blueimp.github.io/JavaScript-Load-Image/">JavaScript Load Image Demo</a></p>

<h2>
<a id="description" class="anchor" href="#description" aria-hidden="true"><span class="octicon octicon-link"></span></a>Description</h2>

<p>JavaScript Load Image is a library to load images provided as File or Blob objects or via URL.<br>
It returns an optionally scaled and/or cropped HTML img or canvas element via an asynchronous callback.<br>
It also provides a method to parse image meta data to extract Exif tags and thumbnails and to restore the complete image header after resizing.</p>

<h2>
<a id="setup" class="anchor" href="#setup" aria-hidden="true"><span class="octicon octicon-link"></span></a>Setup</h2>

<p>Include the (combined and minified) JavaScript Load Image script in your HTML markup:</p>

<div class="highlight highlight-html"><pre>&lt;<span class="pl-ent">script</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">"</span>js/load-image.all.min.js<span class="pl-pds">"</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;</pre></div>

<p>Or alternatively, choose which components you want to include:</p>

<div class="highlight highlight-html"><pre>&lt;<span class="pl-ent">script</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">"</span>js/load-image.js<span class="pl-pds">"</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;
&lt;<span class="pl-ent">script</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">"</span>js/load-image-ios.js<span class="pl-pds">"</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;
&lt;<span class="pl-ent">script</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">"</span>js/load-image-orientation.js<span class="pl-pds">"</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;
&lt;<span class="pl-ent">script</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">"</span>js/load-image-meta.js<span class="pl-pds">"</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;
&lt;<span class="pl-ent">script</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">"</span>js/load-image-exif.js<span class="pl-pds">"</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;
&lt;<span class="pl-ent">script</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">"</span>js/load-image-exif-map.js<span class="pl-pds">"</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;</pre></div>

<h2>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h2>

<h3>
<a id="image-loading" class="anchor" href="#image-loading" aria-hidden="true"><span class="octicon octicon-link"></span></a>Image loading</h3>

<p>In your application code, use the <strong>loadImage()</strong> function like this:</p>

<div class="highlight highlight-js"><pre><span class="pl-c1">document</span>.<span class="pl-c1">getElementById</span>(<span class="pl-s"><span class="pl-pds">'</span>file-input<span class="pl-pds">'</span></span>).<span class="pl-en">onchange</span> <span class="pl-k">=</span> <span class="pl-k">function</span> (<span class="pl-smi">e</span>) {
    loadImage(
        e.<span class="pl-c1">target</span>.files[<span class="pl-c1">0</span>],
        <span class="pl-k">function</span> (<span class="pl-smi">img</span>) {
            <span class="pl-c1">document</span>.<span class="pl-c1">body</span>.<span class="pl-c1">appendChild</span>(img);
        },
        {maxWidth<span class="pl-k">:</span> <span class="pl-c1">600</span>} <span class="pl-c">// Options</span>
    );
};</pre></div>

<h3>
<a id="image-scaling" class="anchor" href="#image-scaling" aria-hidden="true"><span class="octicon octicon-link"></span></a>Image scaling</h3>

<p>It is also possible to use the image scaling functionality with an existing image:</p>

<div class="highlight highlight-js"><pre><span class="pl-k">var</span> scaledImage <span class="pl-k">=</span> loadImage.scale(
    img, <span class="pl-c">// img or canvas element</span>
    {maxWidth<span class="pl-k">:</span> <span class="pl-c1">600</span>}
);</pre></div>

<h2>
<a id="requirements" class="anchor" href="#requirements" aria-hidden="true"><span class="octicon octicon-link"></span></a>Requirements</h2>

<p>The JavaScript Load Image library has zero dependencies.</p>

<p>However, JavaScript Load Image is a very suitable complement to the <a href="https://github.com/blueimp/JavaScript-Canvas-to-Blob">Canvas to Blob</a> library.</p>

<h2>
<a id="api" class="anchor" href="#api" aria-hidden="true"><span class="octicon octicon-link"></span></a>API</h2>

<p>The <strong>loadImage()</strong> function accepts a <a href="https://developer.mozilla.org/en/DOM/File">File</a> or <a href="https://developer.mozilla.org/en/DOM/Blob">Blob</a> object or a simple image URL (e.g. <code>'https://example.org/image.png'</code>) as first argument.</p>

<p>If a <a href="https://developer.mozilla.org/en/DOM/File">File</a> or <a href="https://developer.mozilla.org/en/DOM/Blob">Blob</a> is passed as parameter, it returns a HTML <strong>img</strong> element if the browser supports the <a href="https://developer.mozilla.org/en/DOM/window.URL">URL</a> API or a <a href="https://developer.mozilla.org/en/DOM/FileReader">FileReader</a> object if supported, or <strong>false</strong>.<br>
It always returns a HTML <a href="https://developer.mozilla.org/en/docs/HTML/Element/Img">img</a> element when passing an image URL:</p>

<div class="highlight highlight-js"><pre><span class="pl-c1">document</span>.<span class="pl-c1">getElementById</span>(<span class="pl-s"><span class="pl-pds">'</span>file-input<span class="pl-pds">'</span></span>).<span class="pl-en">onchange</span> <span class="pl-k">=</span> <span class="pl-k">function</span> (<span class="pl-smi">e</span>) {
    <span class="pl-k">var</span> loadingImage <span class="pl-k">=</span> loadImage(
        e.<span class="pl-c1">target</span>.files[<span class="pl-c1">0</span>],
        <span class="pl-k">function</span> (<span class="pl-smi">img</span>) {
            <span class="pl-c1">document</span>.<span class="pl-c1">body</span>.<span class="pl-c1">appendChild</span>(img);
        },
        {maxWidth<span class="pl-k">:</span> <span class="pl-c1">600</span>}
    );
    <span class="pl-k">if</span> (<span class="pl-k">!</span>loadingImage) {
        <span class="pl-c">// Alternative code ...</span>
    }
};</pre></div>

<p>The <strong>img</strong> element or <a href="https://developer.mozilla.org/en/DOM/FileReader">FileReader</a> object returned by the <strong>loadImage()</strong> function allows to abort the loading process by setting the <strong>onload</strong> and <strong>onerror</strong> event handlers to null:</p>

<div class="highlight highlight-js"><pre><span class="pl-c1">document</span>.<span class="pl-c1">getElementById</span>(<span class="pl-s"><span class="pl-pds">'</span>file-input<span class="pl-pds">'</span></span>).<span class="pl-en">onchange</span> <span class="pl-k">=</span> <span class="pl-k">function</span> (<span class="pl-smi">e</span>) {
    <span class="pl-k">var</span> loadingImage <span class="pl-k">=</span> loadImage(
        e.<span class="pl-c1">target</span>.files[<span class="pl-c1">0</span>],
        <span class="pl-k">function</span> (<span class="pl-smi">img</span>) {
            <span class="pl-c1">document</span>.<span class="pl-c1">body</span>.<span class="pl-c1">appendChild</span>(img);
        },
        {maxWidth<span class="pl-k">:</span> <span class="pl-c1">600</span>}
    );
    loadingImage.onload <span class="pl-k">=</span> loadingImage.onerror <span class="pl-k">=</span> <span class="pl-c1">null</span>;
};</pre></div>

<p>The second argument must be a <strong>callback</strong> function, which is called when the image has been loaded or an error occurred while loading the image. The callback function is passed one argument, which is either a HTML <strong>img</strong> element, a <a href="https://developer.mozilla.org/en/HTML/Canvas">canvas</a> element, or an <a href="https://developer.mozilla.org/en/DOM/event">Event</a> object of type <strong>error</strong>:</p>

<div class="highlight highlight-js"><pre><span class="pl-k">var</span> imageUrl <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>https://example.org/image.png<span class="pl-pds">"</span></span>;
loadImage(
    imageUrl,
    <span class="pl-k">function</span> (<span class="pl-smi">img</span>) {
        <span class="pl-k">if</span>(img.<span class="pl-c1">type</span> <span class="pl-k">===</span> <span class="pl-s"><span class="pl-pds">"</span>error<span class="pl-pds">"</span></span>) {
            <span class="pl-en">console</span><span class="pl-c1">.log</span>(<span class="pl-s"><span class="pl-pds">"</span>Error loading image <span class="pl-pds">"</span></span> <span class="pl-k">+</span> imageUrl);
        } <span class="pl-k">else</span> {
            <span class="pl-c1">document</span>.<span class="pl-c1">body</span>.<span class="pl-c1">appendChild</span>(img);
        }
    },
    {maxWidth<span class="pl-k">:</span> <span class="pl-c1">600</span>}
);</pre></div>

<h2>
<a id="options" class="anchor" href="#options" aria-hidden="true"><span class="octicon octicon-link"></span></a>Options</h2>

<p>The optional third argument to <strong>loadImage()</strong> is a map of options:</p>

<ul>
<li>
<strong>maxWidth</strong>: Defines the maximum width of the img/canvas element.</li>
<li>
<strong>maxHeight</strong>: Defines the maximum height of the img/canvas element.</li>
<li>
<strong>minWidth</strong>: Defines the minimum width of the img/canvas element.</li>
<li>
<strong>minHeight</strong>: Defines the minimum height of the img/canvas element.</li>
<li>
<strong>sourceWidth</strong>: The width of the sub-rectangle of the source image to draw into the destination canvas.<br>
Defaults to the source image width and requires <em>canvas: true</em>.</li>
<li>
<strong>sourceHeight</strong>: The height of the sub-rectangle of the source image to draw into the destination canvas.<br>
Defaults to the source image height and requires <em>canvas: true</em>.</li>
<li>
<strong>top</strong>: The top margin of the sub-rectangle of the source image.<br>
Defaults to <em>0</em> and requires <em>canvas: true</em>.</li>
<li>
<strong>right</strong>: The right margin of the sub-rectangle of the source image.<br>
Defaults to <em>0</em> and requires <em>canvas: true</em>.</li>
<li>
<strong>bottom</strong>: The bottom margin of the sub-rectangle of the source image.<br>
Defaults to <em>0</em> and requires <em>canvas: true</em>.</li>
<li>
<strong>left</strong>: The left margin of the sub-rectangle of the source image.<br>
Defaults to <em>0</em> and requires <em>canvas: true</em>.</li>
<li>
<strong>contain</strong>: Scales the image up/down to contain it in the max dimensions if set to <em>true</em>.<br>
This emulates the CSS feature <a href="https://developer.mozilla.org/en-US/docs/Web/Guide/CSS/Scaling_background_images#contain">background-image: contain</a>.</li>
<li>
<strong>cover</strong>: Scales the image up/down to cover the max dimensions with the image dimensions if set to <em>true</em>.<br>
This emulates the CSS feature <a href="https://developer.mozilla.org/en-US/docs/Web/Guide/CSS/Scaling_background_images#cover">background-image: cover</a>.</li>
<li>
<strong>aspectRatio</strong>: Crops the image to the given aspect ratio (e.g. <code>16/9</code>).<br>
This feature assumes <em>crop: true</em>.</li>
<li>
<strong>crop</strong>: Crops the image to the maxWidth/maxHeight constraints if set to <em>true</em>.<br>
This feature assumes <em>canvas: true</em>.</li>
<li>
<strong>orientation</strong>: Allows to transform the canvas coordinates according to the EXIF orientation specification.<br>
This feature assumes <em>canvas: true</em>.</li>
<li>
<strong>canvas</strong>: Returns the image as <a href="https://developer.mozilla.org/en/HTML/Canvas">canvas</a> element if set to <em>true</em>.</li>
<li>
<strong>crossOrigin</strong>: Sets the crossOrigin property on the img element for loading <a href="https://developer.mozilla.org/en-US/docs/HTML/CORS_Enabled_Image">CORS enabled images</a>.</li>
<li>
<strong>noRevoke</strong>: By default, the <a href="https://developer.mozilla.org/en/DOM/window.URL.createObjectURL">created object URL</a> is revoked after the image has been loaded, except when this option is set to <em>true</em>.</li>
</ul>

<p>They can be used the following way:</p>

<div class="highlight highlight-js"><pre>loadImage(
    fileOrBlobOrUrl,
    <span class="pl-k">function</span> (<span class="pl-smi">img</span>) {
        <span class="pl-c1">document</span>.<span class="pl-c1">body</span>.<span class="pl-c1">appendChild</span>(img);
    },
    {
        maxWidth<span class="pl-k">:</span> <span class="pl-c1">600</span>,
        maxHeight<span class="pl-k">:</span> <span class="pl-c1">300</span>,
        minWidth<span class="pl-k">:</span> <span class="pl-c1">100</span>,
        minHeight<span class="pl-k">:</span> <span class="pl-c1">50</span>,
        canvas<span class="pl-k">:</span> <span class="pl-c1">true</span>
    }
);</pre></div>

<p>All settings are optional. By default, the image is returned as HTML <strong>img</strong> element without any image size restrictions.</p>

<h2>
<a id="meta-data-parsing" class="anchor" href="#meta-data-parsing" aria-hidden="true"><span class="octicon octicon-link"></span></a>Meta data parsing</h2>

<p>If the Load Image Meta extension is included, it is also possible to parse image meta data.<br>
The extension provides the method <strong>loadImage.parseMetaData</strong>, which can be used the following way:</p>

<div class="highlight highlight-js"><pre>loadImage.parseMetaData(
    fileOrBlob,
    <span class="pl-k">function</span> (<span class="pl-smi">data</span>) {
        <span class="pl-k">if</span> (<span class="pl-k">!</span>data.imageHead) {
            <span class="pl-k">return</span>;
        }
        <span class="pl-c">// Combine data.imageHead with the image body of a resized file</span>
        <span class="pl-c">// to create scaled images with the original image meta data, e.g.:</span>
        <span class="pl-k">var</span> blob <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Blob</span>([
            data.imageHead,
            <span class="pl-c">// Resized images always have a head size of 20 bytes,</span>
            <span class="pl-c">// including the JPEG marker and a minimal JFIF header:</span>
            loadImage.blobSlice.<span class="pl-c1">call</span>(resizedImage, <span class="pl-c1">20</span>)
        ], {type<span class="pl-k">:</span> resizedImage.<span class="pl-c1">type</span>});
    },
    {
        maxMetaDataSize<span class="pl-k">:</span> <span class="pl-c1">262144</span>,
        disableImageHead<span class="pl-k">:</span> <span class="pl-c1">false</span>
    }
);</pre></div>

<p>The third argument is an options object which defines the maximum number of bytes to parse for the image meta data, allows to disable the imageHead creation and is also passed along to segment parsers registered via loadImage extensions, e.g. the Exif parser.</p>

<p><strong>Note:</strong><br>
Blob objects of resized images can be created via <a href="https://github.com/blueimp/JavaScript-Canvas-to-Blob">canvas.toBlob()</a>.</p>

<h3>
<a id="exif-parser" class="anchor" href="#exif-parser" aria-hidden="true"><span class="octicon octicon-link"></span></a>Exif parser</h3>

<p>If you include the Load Image Exif Parser extension, the <strong>parseMetaData</strong> callback <strong>data</strong> contains the additional property <strong>exif</strong> if Exif data could be found in the given image.<br>
The <strong>exif</strong> object stores the parsed Exif tags:</p>

<div class="highlight highlight-js"><pre><span class="pl-k">var</span> orientation <span class="pl-k">=</span> data.exif[<span class="pl-c1">0x0112</span>];</pre></div>

<p>It also provides an <strong>exif.get()</strong> method to retrieve the tag value via the tag's mapped name:</p>

<div class="highlight highlight-js"><pre><span class="pl-k">var</span> orientation <span class="pl-k">=</span> data.exif.get(<span class="pl-s"><span class="pl-pds">'</span>Orientation<span class="pl-pds">'</span></span>);</pre></div>

<p>By default, the only available mapped names are <strong>Orientation</strong> and <strong>Thumbnail</strong>.<br>
If you also include the Load Image Exif Map library, additional tag mappings become available, as well as two additional methods, <strong>exif.getText()</strong> and <strong>exif.getAll()</strong>:</p>

<div class="highlight highlight-js"><pre><span class="pl-k">var</span> flashText <span class="pl-k">=</span> data.exif.getText(<span class="pl-s"><span class="pl-pds">'</span>Flash<span class="pl-pds">'</span></span>); <span class="pl-c">// e.g.: 'Flash fired, auto mode',</span>

<span class="pl-c">// A map of all parsed tags with their mapped names as keys and their text values:</span>
<span class="pl-k">var</span> allTags <span class="pl-k">=</span> data.exif.getAll();</pre></div>

<p>The Exif parser also adds additional options for the parseMetaData method, to disable certain aspects of the parser:</p>

<ul>
<li>
<strong>disableExif</strong>: Disables Exif parsing.</li>
<li>
<strong>disableExifThumbnail</strong>: Disables parsing of the Exif Thumbnail.</li>
<li>
<strong>disableExifSub</strong>: Disables parsing of the Exif Sub IFD.</li>
<li>
<strong>disableExifGps</strong>: Disables parsing of the Exif GPS Info IFD.</li>
</ul>

<h2>
<a id="ios-scaling-fixes" class="anchor" href="#ios-scaling-fixes" aria-hidden="true"><span class="octicon octicon-link"></span></a>iOS scaling fixes</h2>

<p>Scaling megapixel images in iOS (iPhone, iPad, iPod) can result in distorted (squashed) images.<br>
The Load Image iOS scaling fixes extension resolves these issues.</p>

<h2>
<a id="license" class="anchor" href="#license" aria-hidden="true"><span class="octicon octicon-link"></span></a>License</h2>

<p>The JavaScript Load Image script is released under the <a href="http://www.opensource.org/licenses/MIT">MIT license</a>.</p>

<h2>
<a id="credits" class="anchor" href="#credits" aria-hidden="true"><span class="octicon octicon-link"></span></a>Credits</h2>

<ul>
<li>Image meta data handling implementation based on the help and contribution of Achim Stöhr.</li>
<li>Exif tags mapping based on Jacob Seidelin's <a href="https://github.com/jseidelin/exif-js">exif-js</a>.</li>
<li>iOS image scaling fixes based on Shinichi Tomita's <a href="https://github.com/stomita/ios-imagefile-megapixel">ios-imagefile-megapixel</a>.</li>
</ul>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Javascript-load-image maintained by <a href="https://github.com/jacknam">jacknam</a></p>
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
